clc
close all
clear
%通用的运动学计算

syms a11 a12 a13 a14 a21 a22 a23 a24 a31 a32 a33 a34 vtheta2 vtheta3 vtheta4 k xn yn zn
% INV = inv([a12 a13 a14;a22 a23 a24;a32 a33 a34])
% RANK = rank([a12 a13 a14;a22 a23 a24;a32 a33 a34])
equation(1,1)=a12*vtheta2+a13*vtheta3+a14*vtheta4-k*xn==0;
equation(1,2)=a22*vtheta2+a23*vtheta3+a24*vtheta4-k*yn==0;
% equation(1,3)=a32*vtheta2+a33*vtheta3+a34*vtheta4-k*zn==0;
S = solve(equation,[vtheta2,vtheta3]);
s2 = S.vtheta2
s3 = S.vtheta3
% S.vtheta4
% detthis = det([a12 a13 a14;a22 a23 a24;a32 a33 a34])



syms m0 m1 m2 m3 d1 d2 d3 d4 a0 a1 a2 a3 tool k1 k2 k3 k4 real

A1=[cos(k1) -sin(k1) 0 a0;sin(k1)*cos(m0) cos(k1)*cos(m0) -sin(m0) -sin(m0)*d1;sin(k1)*sin(m0) cos(k1)*sin(m0) cos(m0) cos(m0)*d1;0 0 0 1];
R10 = A1(1:3,1:3);
P10 = A1(1:3,4);
A2=[cos(k2) -sin(k2) 0 a1;sin(k2)*cos(m1) cos(k2)*cos(m1) -sin(m1) -sin(m1)*d2;sin(k2)*sin(m1) cos(k2)*sin(m1) cos(m1) cos(m1)*d2;0 0 0 1];
R21 = A2(1:3,1:3);
P21 = A2(1:3,4);
A3=[cos(k3) -sin(k3) 0 a2;sin(k3)*cos(m2) cos(k3)*cos(m2) -sin(m2) -sin(m2)*d3;sin(k3)*sin(m2) cos(k3)*sin(m2) cos(m2) cos(m2)*d3;0 0 0 1];
R32 = A3(1:3,1:3);
P32 = A3(1:3,4);
A4=[cos(k4) -sin(k4) 0 a3;sin(k4)*cos(m3) cos(k4)*cos(m3) -sin(m3) -sin(m3)*d4;sin(k4)*sin(m3) cos(k4)*sin(m3) cos(m3) cos(m3)*d4;0 0 0 1];
R43 = A4(1:3,1:3);
P43 = A4(1:3,4);
A5=[1 0 0 tool;0 1 0 0;0 0 1 0;0 0 0 1];
R54 = A5(1:3,1:3);
P54 = A5(1:3,4);

Atmp = [1 0 0 tool/2;0 1 0 tool/2;0 0 1 0;0 0 0 1];
Rtmp4 = Atmp(1:3,1:3);
Ptmp4 = Atmp(1:3,4);
Ttmp0 = simplify(A1*A2*A3*A4*Atmp);


T20 = simplify(A1*A2);
T30 = simplify(A1*A2*A3);
T40 = simplify(A1*A2*A3*A4);
T50 = simplify(A1*A2*A3*A4*A5);

%通过以下这些量去判断hessian矩阵正定与否，进而判断x y z f(k1,k2,k3) 是否是凸函数
T40_14 = a0 + a2*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + a1*cos(k1) + a3*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) + d4*cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + d2*sin(k1)*sin(m1) + d4*sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + d3*sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + d3*cos(m2)*sin(k1)*sin(m1);
T40_24 = a2*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) - d1*sin(m0) - a3*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + d4*sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + a1*cos(m0)*sin(k1) - d2*cos(m1)*sin(m0) + d3*sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) + d4*cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - d3*cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - d2*cos(k1)*cos(m0)*sin(m1);
T40_34 = d1*cos(m0) + a3*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + a2*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + d2*cos(m0)*cos(m1) - d4*sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + a1*sin(k1)*sin(m0) - d3*sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - d4*cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + d3*cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - d2*cos(k1)*sin(m0)*sin(m1);

P3minusP2 = T30(1:3,4)-T20(1:3,4)

% T50(1:3,4)-T40(1:3,4) %这个向量的值就是铲斗刚体的方向向量 使得z等于0即可使铲斗始终平行于地面

InvA1 = inv(A1);
R01 = InvA1(1:3,1:3);
InvA2 = inv(A2);
R12 = InvA2(1:3,1:3);
InvA3 = inv(A3);
R23 = InvA3(1:3,1:3);
InvA4 = inv(A4);
R34 = InvA4(1:3,1:3);
InvA5 = inv(A5);
R45 = InvA5(1:3,1:3);


syms d_k1 d_k2 d_k3 d_k4 d_k5 real
Omiga11 = [0;0;d_k1];
v11 = [0;0;0];
Omiga22 = R12*Omiga11 + [0;0;d_k2];
v22 = R12*(v11 + cross(Omiga11,P21));
Omiga33 = R23*Omiga22 + [0;0;d_k3];
v33 = R23*(v22 + cross(Omiga22,P32));
Omiga44 = R34*Omiga33 + [0;0;d_k4];
v44 = R34*(v33 + cross(Omiga33,P43));
Omiga55 = R45*Omiga44 + [0;0;d_k5];
v55 = R45*(v44 + cross(Omiga44,P54));

v55 = simplify(v55);
R50 = R10*R21*R32*R43*R54;
R50 = simplify(R50);
v50 = R50*v55;
% v50 = simplify(v50);
v50 = collect(v50,[d_k1,d_k2,d_k3,d_k4,d_k5]);
       


J11 = ((cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a1*cos(m1)*sin(k2)*sin(k3)*sin(m3) - a2*cos(m1)*cos(m3)*sin(m2) - a3*cos(m1)*cos(m2)*sin(m3) - a1*cos(k2)*cos(m1)*cos(m3)*sin(m2) - a2*cos(k2)*cos(m2)*cos(m3)*sin(m1) - a2*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k3)*cos(m1)*cos(m3)*sin(m2) - tool*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(m2)*cos(m3)*sin(m1) + a3*cos(m3)*sin(k2)*sin(k3)*sin(m1) + a1*cos(k3)*sin(m1)*sin(m2)*sin(m3) + a3*cos(k2)*sin(m1)*sin(m2)*sin(m3) + d2*cos(k2)*sin(k3)*sin(m1)*sin(m3) + d3*cos(k3)*sin(k2)*sin(m1)*sin(m3) + d2*cos(m3)*sin(k2)*sin(m1)*sin(m2) + d3*cos(m1)*sin(k3)*sin(m2)*sin(m3) + tool*cos(k3)*sin(k2)*sin(k4)*sin(m1) + tool*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d2*cos(k3)*cos(m2)*sin(k2)*sin(m1)*sin(m3) + d3*cos(k2)*cos(m2)*sin(k3)*sin(m1)*sin(m3) + tool*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + tool*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) + tool*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(m1) - tool*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a2*cos(k2)*cos(k3)*sin(m1)*sin(m2)*sin(m3) - tool*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1)) - (cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)))*(a1*cos(k4)*sin(k3)*sin(m1)*sin(m2) - a2*cos(k4)*cos(m1)*cos(m2)*sin(k3) - d2*cos(k2)*cos(k3)*cos(k4)*sin(m1) - a3*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k3)*cos(k4)*cos(m1)*sin(m2) - d4*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(k3)*cos(k4)*cos(m1)*sin(k2) + d3*cos(k4)*sin(k2)*sin(k3)*sin(m1) + d4*cos(k3)*sin(k2)*sin(k4)*sin(m1) + a1*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a2*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d4*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d3*cos(m1)*cos(m3)*sin(k3)*sin(k4)*sin(m2) + d4*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a3*sin(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m3) - d2*sin(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k4)*cos(m1)*cos(m2)*sin(k3) - a2*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1) - d4*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a1*cos(m1)*cos(m3)*sin(k2)*sin(k3)*sin(k4) + a2*cos(k2)*cos(k4)*sin(k3)*sin(m1)*sin(m2) + a1*cos(k2)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + a1*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a2*cos(k2)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a3*cos(k2)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k3)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d2*cos(k4)*cos(m2)*sin(k2)*sin(k3)*sin(m1) + d2*cos(k2)*cos(m3)*sin(k3)*sin(k4)*sin(m1) + d3*cos(k3)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d4*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + d4*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d4*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + d2*cos(k3)*cos(m2)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d3*cos(k2)*cos(m2)*cos(m3)*sin(k3)*sin(k4)*sin(m1)) + (sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a1*cos(k3)*cos(m1)*sin(k2)*sin(k4) - a3*cos(k4)*cos(m1)*cos(m2)*cos(m3) - tool*cos(m1)*cos(m2)*cos(m3) + a2*cos(m1)*cos(m2)*sin(k3)*sin(k4) + d2*cos(k2)*cos(k3)*sin(k4)*sin(m1) + d4*cos(k3)*cos(k4)*sin(k2)*sin(m1) + a1*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a2*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d3*cos(k3)*cos(m1)*sin(k4)*sin(m2) + d4*cos(k4)*cos(m1)*sin(k3)*sin(m2) + d4*cos(m1)*cos(m2)*sin(k4)*sin(m3) + tool*cos(k2)*cos(m3)*sin(m1)*sin(m2) + tool*cos(k3)*cos(m1)*sin(m2)*sin(m3) - a1*sin(k3)*sin(k4)*sin(m1)*sin(m2) - d3*sin(k2)*sin(k3)*sin(k4)*sin(m1) - tool*sin(k2)*sin(k3)*sin(m1)*sin(m3) + tool*cos(k2)*cos(k3)*cos(m2)*sin(m1)*sin(m3) - a2*cos(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m2) - a3*cos(k4)*sin(k2)*sin(k3)*sin(m1)*sin(m3) - d2*cos(m2)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d4*cos(m3)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d2*cos(k4)*sin(k2)*sin(m1)*sin(m2)*sin(m3) - d4*cos(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a2*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a1*cos(k2)*cos(m1)*cos(m2)*sin(k3)*sin(k4) + a1*cos(k4)*cos(m1)*cos(m3)*sin(k2)*sin(k3) + a1*cos(k2)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + a1*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a2*cos(k2)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a3*cos(k2)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k3)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d2*cos(k2)*cos(k4)*cos(m3)*sin(k3)*sin(m1) + d3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1) + d3*cos(k3)*cos(k4)*cos(m3)*sin(k2)*sin(m1) + d4*cos(k2)*cos(k4)*cos(m2)*sin(k3)*sin(m1) + d3*cos(k4)*cos(m1)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m1)*cos(m3)*sin(k4)*sin(m2) - a1*cos(k2)*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(k2)*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + d2*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(k2)*sin(m1) + d3*cos(k2)*cos(k4)*cos(m2)*cos(m3)*sin(k3)*sin(m1) + d4*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(k4)*sin(m1)));
J12 = ((sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) - tool*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + tool*cos(k3)*sin(m2)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) - (cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) + tool*cos(k4)*cos(m2)*sin(m3) - d3*sin(k3)*sin(m2)*sin(m3) - tool*sin(k3)*sin(k4)*sin(m2) + tool*cos(k3)*cos(k4)*cos(m3)*sin(m2)) + (cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)));
J13 = ((a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1))) - (a3*sin(m3) + tool*cos(k4)*sin(m3))*(cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2))) - (sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(tool*cos(m3) + a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3)));
J14 = (-tool*(sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2))));

J21 = ((cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a1*cos(m1)*sin(k2)*sin(k3)*sin(m3) - a2*cos(m1)*cos(m3)*sin(m2) - a3*cos(m1)*cos(m2)*sin(m3) - a1*cos(k2)*cos(m1)*cos(m3)*sin(m2) - a2*cos(k2)*cos(m2)*cos(m3)*sin(m1) - a2*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k3)*cos(m1)*cos(m3)*sin(m2) - tool*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(m2)*cos(m3)*sin(m1) + a3*cos(m3)*sin(k2)*sin(k3)*sin(m1) + a1*cos(k3)*sin(m1)*sin(m2)*sin(m3) + a3*cos(k2)*sin(m1)*sin(m2)*sin(m3) + d2*cos(k2)*sin(k3)*sin(m1)*sin(m3) + d3*cos(k3)*sin(k2)*sin(m1)*sin(m3) + d2*cos(m3)*sin(k2)*sin(m1)*sin(m2) + d3*cos(m1)*sin(k3)*sin(m2)*sin(m3) + tool*cos(k3)*sin(k2)*sin(k4)*sin(m1) + tool*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d2*cos(k3)*cos(m2)*sin(k2)*sin(m1)*sin(m3) + d3*cos(k2)*cos(m2)*sin(k3)*sin(m1)*sin(m3) + tool*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + tool*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) + tool*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(m1) - tool*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a2*cos(k2)*cos(k3)*sin(m1)*sin(m2)*sin(m3) - tool*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1)) - (sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a1*cos(k3)*cos(m1)*sin(k2)*sin(k4) - a3*cos(k4)*cos(m1)*cos(m2)*cos(m3) - tool*cos(m1)*cos(m2)*cos(m3) + a2*cos(m1)*cos(m2)*sin(k3)*sin(k4) + d2*cos(k2)*cos(k3)*sin(k4)*sin(m1) + d4*cos(k3)*cos(k4)*sin(k2)*sin(m1) + a1*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a2*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d3*cos(k3)*cos(m1)*sin(k4)*sin(m2) + d4*cos(k4)*cos(m1)*sin(k3)*sin(m2) + d4*cos(m1)*cos(m2)*sin(k4)*sin(m3) + tool*cos(k2)*cos(m3)*sin(m1)*sin(m2) + tool*cos(k3)*cos(m1)*sin(m2)*sin(m3) - a1*sin(k3)*sin(k4)*sin(m1)*sin(m2) - d3*sin(k2)*sin(k3)*sin(k4)*sin(m1) - tool*sin(k2)*sin(k3)*sin(m1)*sin(m3) + tool*cos(k2)*cos(k3)*cos(m2)*sin(m1)*sin(m3) - a2*cos(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m2) - a3*cos(k4)*sin(k2)*sin(k3)*sin(m1)*sin(m3) - d2*cos(m2)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d4*cos(m3)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d2*cos(k4)*sin(k2)*sin(m1)*sin(m2)*sin(m3) - d4*cos(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a2*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a1*cos(k2)*cos(m1)*cos(m2)*sin(k3)*sin(k4) + a1*cos(k4)*cos(m1)*cos(m3)*sin(k2)*sin(k3) + a1*cos(k2)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + a1*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a2*cos(k2)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a3*cos(k2)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k3)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d2*cos(k2)*cos(k4)*cos(m3)*sin(k3)*sin(m1) + d3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1) + d3*cos(k3)*cos(k4)*cos(m3)*sin(k2)*sin(m1) + d4*cos(k2)*cos(k4)*cos(m2)*sin(k3)*sin(m1) + d3*cos(k4)*cos(m1)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m1)*cos(m3)*sin(k4)*sin(m2) - a1*cos(k2)*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(k2)*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + d2*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(k2)*sin(m1) + d3*cos(k2)*cos(k4)*cos(m2)*cos(m3)*sin(k3)*sin(m1) + d4*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(k4)*sin(m1)) + (cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a1*cos(k4)*sin(k3)*sin(m1)*sin(m2) - a2*cos(k4)*cos(m1)*cos(m2)*sin(k3) - d2*cos(k2)*cos(k3)*cos(k4)*sin(m1) - a3*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k3)*cos(k4)*cos(m1)*sin(m2) - d4*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(k3)*cos(k4)*cos(m1)*sin(k2) + d3*cos(k4)*sin(k2)*sin(k3)*sin(m1) + d4*cos(k3)*sin(k2)*sin(k4)*sin(m1) + a1*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a2*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d4*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d3*cos(m1)*cos(m3)*sin(k3)*sin(k4)*sin(m2) + d4*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a3*sin(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m3) - d2*sin(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k4)*cos(m1)*cos(m2)*sin(k3) - a2*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1) - d4*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a1*cos(m1)*cos(m3)*sin(k2)*sin(k3)*sin(k4) + a2*cos(k2)*cos(k4)*sin(k3)*sin(m1)*sin(m2) + a1*cos(k2)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + a1*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a2*cos(k2)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a3*cos(k2)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k3)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d2*cos(k4)*cos(m2)*sin(k2)*sin(k3)*sin(m1) + d2*cos(k2)*cos(m3)*sin(k3)*sin(k4)*sin(m1) + d3*cos(k3)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d4*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + d4*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d4*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + d2*cos(k3)*cos(m2)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d3*cos(k2)*cos(m2)*cos(m3)*sin(k3)*sin(k4)*sin(m1)));
J22 = (- (cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)) - (sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) - tool*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + tool*cos(k3)*sin(m2)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) - (cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) + tool*cos(k4)*cos(m2)*sin(m3) - d3*sin(k3)*sin(m2)*sin(m3) - tool*sin(k3)*sin(k4)*sin(m2) + tool*cos(k3)*cos(k4)*cos(m3)*sin(m2)));
J23 = ((sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(tool*cos(m3) + a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3)) - (cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a3*sin(m3) + tool*cos(k4)*sin(m3)) - (a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)))));
J24 = tool*(sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))));

J31 = ((sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a1*cos(k3)*cos(m1)*sin(k2)*sin(k4) - a3*cos(k4)*cos(m1)*cos(m2)*cos(m3) - tool*cos(m1)*cos(m2)*cos(m3) + a2*cos(m1)*cos(m2)*sin(k3)*sin(k4) + d2*cos(k2)*cos(k3)*sin(k4)*sin(m1) + d4*cos(k3)*cos(k4)*sin(k2)*sin(m1) + a1*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a2*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d3*cos(k3)*cos(m1)*sin(k4)*sin(m2) + d4*cos(k4)*cos(m1)*sin(k3)*sin(m2) + d4*cos(m1)*cos(m2)*sin(k4)*sin(m3) + tool*cos(k2)*cos(m3)*sin(m1)*sin(m2) + tool*cos(k3)*cos(m1)*sin(m2)*sin(m3) - a1*sin(k3)*sin(k4)*sin(m1)*sin(m2) - d3*sin(k2)*sin(k3)*sin(k4)*sin(m1) - tool*sin(k2)*sin(k3)*sin(m1)*sin(m3) + tool*cos(k2)*cos(k3)*cos(m2)*sin(m1)*sin(m3) - a2*cos(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m2) - a3*cos(k4)*sin(k2)*sin(k3)*sin(m1)*sin(m3) - d2*cos(m2)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d4*cos(m3)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d2*cos(k4)*sin(k2)*sin(m1)*sin(m2)*sin(m3) - d4*cos(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a2*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a1*cos(k2)*cos(m1)*cos(m2)*sin(k3)*sin(k4) + a1*cos(k4)*cos(m1)*cos(m3)*sin(k2)*sin(k3) + a1*cos(k2)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + a1*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a2*cos(k2)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a3*cos(k2)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k3)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d2*cos(k2)*cos(k4)*cos(m3)*sin(k3)*sin(m1) + d3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1) + d3*cos(k3)*cos(k4)*cos(m3)*sin(k2)*sin(m1) + d4*cos(k2)*cos(k4)*cos(m2)*sin(k3)*sin(m1) + d3*cos(k4)*cos(m1)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m1)*cos(m3)*sin(k4)*sin(m2) - a1*cos(k2)*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(k2)*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + d2*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(k2)*sin(m1) + d3*cos(k2)*cos(k4)*cos(m2)*cos(m3)*sin(k3)*sin(m1) + d4*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(k4)*sin(m1)) - (sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a1*cos(m1)*sin(k2)*sin(k3)*sin(m3) - a2*cos(m1)*cos(m3)*sin(m2) - a3*cos(m1)*cos(m2)*sin(m3) - a1*cos(k2)*cos(m1)*cos(m3)*sin(m2) - a2*cos(k2)*cos(m2)*cos(m3)*sin(m1) - a2*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k3)*cos(m1)*cos(m3)*sin(m2) - tool*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(m2)*cos(m3)*sin(m1) + a3*cos(m3)*sin(k2)*sin(k3)*sin(m1) + a1*cos(k3)*sin(m1)*sin(m2)*sin(m3) + a3*cos(k2)*sin(m1)*sin(m2)*sin(m3) + d2*cos(k2)*sin(k3)*sin(m1)*sin(m3) + d3*cos(k3)*sin(k2)*sin(m1)*sin(m3) + d2*cos(m3)*sin(k2)*sin(m1)*sin(m2) + d3*cos(m1)*sin(k3)*sin(m2)*sin(m3) + tool*cos(k3)*sin(k2)*sin(k4)*sin(m1) + tool*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d2*cos(k3)*cos(m2)*sin(k2)*sin(m1)*sin(m3) + d3*cos(k2)*cos(m2)*sin(k3)*sin(m1)*sin(m3) + tool*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + tool*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) + tool*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(m1) - tool*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a2*cos(k2)*cos(k3)*sin(m1)*sin(m2)*sin(m3) - tool*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1)) - (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a1*cos(k4)*sin(k3)*sin(m1)*sin(m2) - a2*cos(k4)*cos(m1)*cos(m2)*sin(k3) - d2*cos(k2)*cos(k3)*cos(k4)*sin(m1) - a3*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k3)*cos(k4)*cos(m1)*sin(m2) - d4*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(k3)*cos(k4)*cos(m1)*sin(k2) + d3*cos(k4)*sin(k2)*sin(k3)*sin(m1) + d4*cos(k3)*sin(k2)*sin(k4)*sin(m1) + a1*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a2*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d4*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d3*cos(m1)*cos(m3)*sin(k3)*sin(k4)*sin(m2) + d4*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a3*sin(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m3) - d2*sin(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k4)*cos(m1)*cos(m2)*sin(k3) - a2*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1) - d4*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a1*cos(m1)*cos(m3)*sin(k2)*sin(k3)*sin(k4) + a2*cos(k2)*cos(k4)*sin(k3)*sin(m1)*sin(m2) + a1*cos(k2)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + a1*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a2*cos(k2)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a3*cos(k2)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k3)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d2*cos(k4)*cos(m2)*sin(k2)*sin(k3)*sin(m1) + d2*cos(k2)*cos(m3)*sin(k3)*sin(k4)*sin(m1) + d3*cos(k3)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d4*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + d4*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d4*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + d2*cos(k3)*cos(m2)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d3*cos(k2)*cos(m2)*cos(m3)*sin(k3)*sin(k4)*sin(m1)));
J32 = ((sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) + tool*cos(k4)*cos(m2)*sin(m3) - d3*sin(k3)*sin(m2)*sin(m3) - tool*sin(k3)*sin(k4)*sin(m2) + tool*cos(k3)*cos(k4)*cos(m3)*sin(m2)) + (sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) - tool*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + tool*cos(k3)*sin(m2)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) + (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)));
J33 = ((a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)))) + (a3*sin(m3) + tool*cos(k4)*sin(m3))*(sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)))) - (sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(tool*cos(m3) + a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3)));
J34 = (-tool*(sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)))));



v44 = simplify(v44);
R40 = R10*R21*R32*R43;
R40 = simplify(R40);
v40 = R40*v44;

% v40 = simplify(v40);
% v40 = collect(v40,[d_k1,d_k2,d_k3]);

v401 = ((sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a1*cos(k3)*cos(m1)*sin(k2)*sin(k4) - a3*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(m1)*cos(m2)*sin(k3)*sin(k4) + d2*cos(k2)*cos(k3)*sin(k4)*sin(m1) + d4*cos(k3)*cos(k4)*sin(k2)*sin(m1) + a1*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a2*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d3*cos(k3)*cos(m1)*sin(k4)*sin(m2) + d4*cos(k4)*cos(m1)*sin(k3)*sin(m2) + d4*cos(m1)*cos(m2)*sin(k4)*sin(m3) - a1*sin(k3)*sin(k4)*sin(m1)*sin(m2) - d3*sin(k2)*sin(k3)*sin(k4)*sin(m1) - a2*cos(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m2) - a3*cos(k4)*sin(k2)*sin(k3)*sin(m1)*sin(m3) - d2*cos(m2)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d4*cos(m3)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d2*cos(k4)*sin(k2)*sin(m1)*sin(m2)*sin(m3) - d4*cos(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a2*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a1*cos(k2)*cos(m1)*cos(m2)*sin(k3)*sin(k4) + a1*cos(k4)*cos(m1)*cos(m3)*sin(k2)*sin(k3) + a1*cos(k2)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + a1*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a2*cos(k2)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a3*cos(k2)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k3)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d2*cos(k2)*cos(k4)*cos(m3)*sin(k3)*sin(m1) + d3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1) + d3*cos(k3)*cos(k4)*cos(m3)*sin(k2)*sin(m1) + d4*cos(k2)*cos(k4)*cos(m2)*sin(k3)*sin(m1) + d3*cos(k4)*cos(m1)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m1)*cos(m3)*sin(k4)*sin(m2) - a1*cos(k2)*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(k2)*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + d2*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(k2)*sin(m1) + d3*cos(k2)*cos(k4)*cos(m2)*cos(m3)*sin(k3)*sin(m1) + d4*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(k4)*sin(m1)) - (cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)))*(a1*cos(k4)*sin(k3)*sin(m1)*sin(m2) - a2*cos(k4)*cos(m1)*cos(m2)*sin(k3) - d2*cos(k2)*cos(k3)*cos(k4)*sin(m1) - a3*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k3)*cos(k4)*cos(m1)*sin(m2) - d4*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(k3)*cos(k4)*cos(m1)*sin(k2) + d3*cos(k4)*sin(k2)*sin(k3)*sin(m1) + d4*cos(k3)*sin(k2)*sin(k4)*sin(m1) + a1*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a2*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d4*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d3*cos(m1)*cos(m3)*sin(k3)*sin(k4)*sin(m2) + d4*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a3*sin(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m3) - d2*sin(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k4)*cos(m1)*cos(m2)*sin(k3) - a2*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1) - d4*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a1*cos(m1)*cos(m3)*sin(k2)*sin(k3)*sin(k4) + a2*cos(k2)*cos(k4)*sin(k3)*sin(m1)*sin(m2) + a1*cos(k2)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + a1*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a2*cos(k2)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a3*cos(k2)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k3)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d2*cos(k4)*cos(m2)*sin(k2)*sin(k3)*sin(m1) + d2*cos(k2)*cos(m3)*sin(k3)*sin(k4)*sin(m1) + d3*cos(k3)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d4*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + d4*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d4*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + d2*cos(k3)*cos(m2)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d3*cos(k2)*cos(m2)*cos(m3)*sin(k3)*sin(k4)*sin(m1)) + (cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a1*cos(m1)*sin(k2)*sin(k3)*sin(m3) - a2*cos(m1)*cos(m3)*sin(m2) - a3*cos(m1)*cos(m2)*sin(m3) - a1*cos(k2)*cos(m1)*cos(m3)*sin(m2) - a2*cos(k2)*cos(m2)*cos(m3)*sin(m1) - a2*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k3)*cos(m1)*cos(m3)*sin(m2) - a1*cos(m2)*cos(m3)*sin(m1) + a3*cos(m3)*sin(k2)*sin(k3)*sin(m1) + a1*cos(k3)*sin(m1)*sin(m2)*sin(m3) + a3*cos(k2)*sin(m1)*sin(m2)*sin(m3) + d2*cos(k2)*sin(k3)*sin(m1)*sin(m3) + d3*cos(k3)*sin(k2)*sin(m1)*sin(m3) + d2*cos(m3)*sin(k2)*sin(m1)*sin(m2) + d3*cos(m1)*sin(k3)*sin(m2)*sin(m3) + d2*cos(k3)*cos(m2)*sin(k2)*sin(m1)*sin(m3) + d3*cos(k2)*cos(m2)*sin(k3)*sin(m1)*sin(m3) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*sin(m1)*sin(m2)*sin(m3)))*d_k1 + ((sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) - (cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)))*d_k2 + ((a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1))) - (a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3))*(sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2))) - a3*sin(m3)*(cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2))))*d_k3;
v402 = ((cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a1*cos(m1)*sin(k2)*sin(k3)*sin(m3) - a2*cos(m1)*cos(m3)*sin(m2) - a3*cos(m1)*cos(m2)*sin(m3) - a1*cos(k2)*cos(m1)*cos(m3)*sin(m2) - a2*cos(k2)*cos(m2)*cos(m3)*sin(m1) - a2*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k3)*cos(m1)*cos(m3)*sin(m2) - a1*cos(m2)*cos(m3)*sin(m1) + a3*cos(m3)*sin(k2)*sin(k3)*sin(m1) + a1*cos(k3)*sin(m1)*sin(m2)*sin(m3) + a3*cos(k2)*sin(m1)*sin(m2)*sin(m3) + d2*cos(k2)*sin(k3)*sin(m1)*sin(m3) + d3*cos(k3)*sin(k2)*sin(m1)*sin(m3) + d2*cos(m3)*sin(k2)*sin(m1)*sin(m2) + d3*cos(m1)*sin(k3)*sin(m2)*sin(m3) + d2*cos(k3)*cos(m2)*sin(k2)*sin(m1)*sin(m3) + d3*cos(k2)*cos(m2)*sin(k3)*sin(m1)*sin(m3) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*sin(m1)*sin(m2)*sin(m3)) - (sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a1*cos(k3)*cos(m1)*sin(k2)*sin(k4) - a3*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(m1)*cos(m2)*sin(k3)*sin(k4) + d2*cos(k2)*cos(k3)*sin(k4)*sin(m1) + d4*cos(k3)*cos(k4)*sin(k2)*sin(m1) + a1*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a2*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d3*cos(k3)*cos(m1)*sin(k4)*sin(m2) + d4*cos(k4)*cos(m1)*sin(k3)*sin(m2) + d4*cos(m1)*cos(m2)*sin(k4)*sin(m3) - a1*sin(k3)*sin(k4)*sin(m1)*sin(m2) - d3*sin(k2)*sin(k3)*sin(k4)*sin(m1) - a2*cos(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m2) - a3*cos(k4)*sin(k2)*sin(k3)*sin(m1)*sin(m3) - d2*cos(m2)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d4*cos(m3)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d2*cos(k4)*sin(k2)*sin(m1)*sin(m2)*sin(m3) - d4*cos(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a2*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a1*cos(k2)*cos(m1)*cos(m2)*sin(k3)*sin(k4) + a1*cos(k4)*cos(m1)*cos(m3)*sin(k2)*sin(k3) + a1*cos(k2)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + a1*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a2*cos(k2)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a3*cos(k2)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k3)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d2*cos(k2)*cos(k4)*cos(m3)*sin(k3)*sin(m1) + d3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1) + d3*cos(k3)*cos(k4)*cos(m3)*sin(k2)*sin(m1) + d4*cos(k2)*cos(k4)*cos(m2)*sin(k3)*sin(m1) + d3*cos(k4)*cos(m1)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m1)*cos(m3)*sin(k4)*sin(m2) - a1*cos(k2)*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(k2)*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + d2*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(k2)*sin(m1) + d3*cos(k2)*cos(k4)*cos(m2)*cos(m3)*sin(k3)*sin(m1) + d4*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(k4)*sin(m1)) + (cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a1*cos(k4)*sin(k3)*sin(m1)*sin(m2) - a2*cos(k4)*cos(m1)*cos(m2)*sin(k3) - d2*cos(k2)*cos(k3)*cos(k4)*sin(m1) - a3*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k3)*cos(k4)*cos(m1)*sin(m2) - d4*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(k3)*cos(k4)*cos(m1)*sin(k2) + d3*cos(k4)*sin(k2)*sin(k3)*sin(m1) + d4*cos(k3)*sin(k2)*sin(k4)*sin(m1) + a1*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a2*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d4*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d3*cos(m1)*cos(m3)*sin(k3)*sin(k4)*sin(m2) + d4*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a3*sin(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m3) - d2*sin(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k4)*cos(m1)*cos(m2)*sin(k3) - a2*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1) - d4*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a1*cos(m1)*cos(m3)*sin(k2)*sin(k3)*sin(k4) + a2*cos(k2)*cos(k4)*sin(k3)*sin(m1)*sin(m2) + a1*cos(k2)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + a1*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a2*cos(k2)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a3*cos(k2)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k3)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d2*cos(k4)*cos(m2)*sin(k2)*sin(k3)*sin(m1) + d2*cos(k2)*cos(m3)*sin(k3)*sin(k4)*sin(m1) + d3*cos(k3)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d4*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + d4*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d4*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + d2*cos(k3)*cos(m2)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d3*cos(k2)*cos(m2)*cos(m3)*sin(k3)*sin(k4)*sin(m1)))*d_k1 + (- (cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) - (cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)) - (sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)))*d_k2 + ((a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3))*(sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)))) - (a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)))) - a3*sin(m3)*(cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)))))*d_k3;
v403 = ((sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a1*cos(k3)*cos(m1)*sin(k2)*sin(k4) - a3*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(m1)*cos(m2)*sin(k3)*sin(k4) + d2*cos(k2)*cos(k3)*sin(k4)*sin(m1) + d4*cos(k3)*cos(k4)*sin(k2)*sin(m1) + a1*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a2*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d3*cos(k3)*cos(m1)*sin(k4)*sin(m2) + d4*cos(k4)*cos(m1)*sin(k3)*sin(m2) + d4*cos(m1)*cos(m2)*sin(k4)*sin(m3) - a1*sin(k3)*sin(k4)*sin(m1)*sin(m2) - d3*sin(k2)*sin(k3)*sin(k4)*sin(m1) - a2*cos(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m2) - a3*cos(k4)*sin(k2)*sin(k3)*sin(m1)*sin(m3) - d2*cos(m2)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d4*cos(m3)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d2*cos(k4)*sin(k2)*sin(m1)*sin(m2)*sin(m3) - d4*cos(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a2*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a1*cos(k2)*cos(m1)*cos(m2)*sin(k3)*sin(k4) + a1*cos(k4)*cos(m1)*cos(m3)*sin(k2)*sin(k3) + a1*cos(k2)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + a1*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a2*cos(k2)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a3*cos(k2)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k3)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d2*cos(k2)*cos(k4)*cos(m3)*sin(k3)*sin(m1) + d3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1) + d3*cos(k3)*cos(k4)*cos(m3)*sin(k2)*sin(m1) + d4*cos(k2)*cos(k4)*cos(m2)*sin(k3)*sin(m1) + d3*cos(k4)*cos(m1)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m1)*cos(m3)*sin(k4)*sin(m2) - a1*cos(k2)*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(k2)*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + d2*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(k2)*sin(m1) + d3*cos(k2)*cos(k4)*cos(m2)*cos(m3)*sin(k3)*sin(m1) + d4*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(k4)*sin(m1)) - (sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a1*cos(m1)*sin(k2)*sin(k3)*sin(m3) - a2*cos(m1)*cos(m3)*sin(m2) - a3*cos(m1)*cos(m2)*sin(m3) - a1*cos(k2)*cos(m1)*cos(m3)*sin(m2) - a2*cos(k2)*cos(m2)*cos(m3)*sin(m1) - a2*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k3)*cos(m1)*cos(m3)*sin(m2) - a1*cos(m2)*cos(m3)*sin(m1) + a3*cos(m3)*sin(k2)*sin(k3)*sin(m1) + a1*cos(k3)*sin(m1)*sin(m2)*sin(m3) + a3*cos(k2)*sin(m1)*sin(m2)*sin(m3) + d2*cos(k2)*sin(k3)*sin(m1)*sin(m3) + d3*cos(k3)*sin(k2)*sin(m1)*sin(m3) + d2*cos(m3)*sin(k2)*sin(m1)*sin(m2) + d3*cos(m1)*sin(k3)*sin(m2)*sin(m3) + d2*cos(k3)*cos(m2)*sin(k2)*sin(m1)*sin(m3) + d3*cos(k2)*cos(m2)*sin(k3)*sin(m1)*sin(m3) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*sin(m1)*sin(m2)*sin(m3)) - (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a1*cos(k4)*sin(k3)*sin(m1)*sin(m2) - a2*cos(k4)*cos(m1)*cos(m2)*sin(k3) - d2*cos(k2)*cos(k3)*cos(k4)*sin(m1) - a3*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k3)*cos(k4)*cos(m1)*sin(m2) - d4*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(k3)*cos(k4)*cos(m1)*sin(k2) + d3*cos(k4)*sin(k2)*sin(k3)*sin(m1) + d4*cos(k3)*sin(k2)*sin(k4)*sin(m1) + a1*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a2*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d4*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d3*cos(m1)*cos(m3)*sin(k3)*sin(k4)*sin(m2) + d4*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a3*sin(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m3) - d2*sin(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k4)*cos(m1)*cos(m2)*sin(k3) - a2*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1) - d4*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a1*cos(m1)*cos(m3)*sin(k2)*sin(k3)*sin(k4) + a2*cos(k2)*cos(k4)*sin(k3)*sin(m1)*sin(m2) + a1*cos(k2)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + a1*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a2*cos(k2)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a3*cos(k2)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k3)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d2*cos(k4)*cos(m2)*sin(k2)*sin(k3)*sin(m1) + d2*cos(k2)*cos(m3)*sin(k3)*sin(k4)*sin(m1) + d3*cos(k3)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d4*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + d4*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d4*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + d2*cos(k3)*cos(m2)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d3*cos(k2)*cos(m2)*cos(m3)*sin(k3)*sin(k4)*sin(m1)))*d_k1 + ((sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) + (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)))*d_k2 + ((a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)))) - (a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3))*(sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)))) + a3*sin(m3)*(sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)))))*d_k3;


v401d_k1 = ((sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a1*cos(k3)*cos(m1)*sin(k2)*sin(k4) - a3*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(m1)*cos(m2)*sin(k3)*sin(k4) + d2*cos(k2)*cos(k3)*sin(k4)*sin(m1) + d4*cos(k3)*cos(k4)*sin(k2)*sin(m1) + a1*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a2*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d3*cos(k3)*cos(m1)*sin(k4)*sin(m2) + d4*cos(k4)*cos(m1)*sin(k3)*sin(m2) + d4*cos(m1)*cos(m2)*sin(k4)*sin(m3) - a1*sin(k3)*sin(k4)*sin(m1)*sin(m2) - d3*sin(k2)*sin(k3)*sin(k4)*sin(m1) - a2*cos(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m2) - a3*cos(k4)*sin(k2)*sin(k3)*sin(m1)*sin(m3) - d2*cos(m2)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d4*cos(m3)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d2*cos(k4)*sin(k2)*sin(m1)*sin(m2)*sin(m3) - d4*cos(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a2*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a1*cos(k2)*cos(m1)*cos(m2)*sin(k3)*sin(k4) + a1*cos(k4)*cos(m1)*cos(m3)*sin(k2)*sin(k3) + a1*cos(k2)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + a1*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a2*cos(k2)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a3*cos(k2)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k3)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d2*cos(k2)*cos(k4)*cos(m3)*sin(k3)*sin(m1) + d3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1) + d3*cos(k3)*cos(k4)*cos(m3)*sin(k2)*sin(m1) + d4*cos(k2)*cos(k4)*cos(m2)*sin(k3)*sin(m1) + d3*cos(k4)*cos(m1)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m1)*cos(m3)*sin(k4)*sin(m2) - a1*cos(k2)*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(k2)*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + d2*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(k2)*sin(m1) + d3*cos(k2)*cos(k4)*cos(m2)*cos(m3)*sin(k3)*sin(m1) + d4*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(k4)*sin(m1)) - (cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)))*(a1*cos(k4)*sin(k3)*sin(m1)*sin(m2) - a2*cos(k4)*cos(m1)*cos(m2)*sin(k3) - d2*cos(k2)*cos(k3)*cos(k4)*sin(m1) - a3*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k3)*cos(k4)*cos(m1)*sin(m2) - d4*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(k3)*cos(k4)*cos(m1)*sin(k2) + d3*cos(k4)*sin(k2)*sin(k3)*sin(m1) + d4*cos(k3)*sin(k2)*sin(k4)*sin(m1) + a1*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a2*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d4*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d3*cos(m1)*cos(m3)*sin(k3)*sin(k4)*sin(m2) + d4*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a3*sin(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m3) - d2*sin(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k4)*cos(m1)*cos(m2)*sin(k3) - a2*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1) - d4*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a1*cos(m1)*cos(m3)*sin(k2)*sin(k3)*sin(k4) + a2*cos(k2)*cos(k4)*sin(k3)*sin(m1)*sin(m2) + a1*cos(k2)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + a1*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a2*cos(k2)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a3*cos(k2)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k3)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d2*cos(k4)*cos(m2)*sin(k2)*sin(k3)*sin(m1) + d2*cos(k2)*cos(m3)*sin(k3)*sin(k4)*sin(m1) + d3*cos(k3)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d4*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + d4*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d4*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + d2*cos(k3)*cos(m2)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d3*cos(k2)*cos(m2)*cos(m3)*sin(k3)*sin(k4)*sin(m1)) + (cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a1*cos(m1)*sin(k2)*sin(k3)*sin(m3) - a2*cos(m1)*cos(m3)*sin(m2) - a3*cos(m1)*cos(m2)*sin(m3) - a1*cos(k2)*cos(m1)*cos(m3)*sin(m2) - a2*cos(k2)*cos(m2)*cos(m3)*sin(m1) - a2*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k3)*cos(m1)*cos(m3)*sin(m2) - a1*cos(m2)*cos(m3)*sin(m1) + a3*cos(m3)*sin(k2)*sin(k3)*sin(m1) + a1*cos(k3)*sin(m1)*sin(m2)*sin(m3) + a3*cos(k2)*sin(m1)*sin(m2)*sin(m3) + d2*cos(k2)*sin(k3)*sin(m1)*sin(m3) + d3*cos(k3)*sin(k2)*sin(m1)*sin(m3) + d2*cos(m3)*sin(k2)*sin(m1)*sin(m2) + d3*cos(m1)*sin(k3)*sin(m2)*sin(m3) + d2*cos(k3)*cos(m2)*sin(k2)*sin(m1)*sin(m3) + d3*cos(k2)*cos(m2)*sin(k3)*sin(m1)*sin(m3) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*sin(m1)*sin(m2)*sin(m3)))*d_k1;
v401d_k2 = ((sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) - (cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)))*d_k2;
v401d_k3 = ((a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1))) - (a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3))*(sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2))) - a3*sin(m3)*(cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2))))*d_k3;

Jacobo11 = ((sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a1*cos(k3)*cos(m1)*sin(k2)*sin(k4) - a3*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(m1)*cos(m2)*sin(k3)*sin(k4) + d2*cos(k2)*cos(k3)*sin(k4)*sin(m1) + d4*cos(k3)*cos(k4)*sin(k2)*sin(m1) + a1*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a2*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d3*cos(k3)*cos(m1)*sin(k4)*sin(m2) + d4*cos(k4)*cos(m1)*sin(k3)*sin(m2) + d4*cos(m1)*cos(m2)*sin(k4)*sin(m3) - a1*sin(k3)*sin(k4)*sin(m1)*sin(m2) - d3*sin(k2)*sin(k3)*sin(k4)*sin(m1) - a2*cos(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m2) - a3*cos(k4)*sin(k2)*sin(k3)*sin(m1)*sin(m3) - d2*cos(m2)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d4*cos(m3)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d2*cos(k4)*sin(k2)*sin(m1)*sin(m2)*sin(m3) - d4*cos(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a2*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a1*cos(k2)*cos(m1)*cos(m2)*sin(k3)*sin(k4) + a1*cos(k4)*cos(m1)*cos(m3)*sin(k2)*sin(k3) + a1*cos(k2)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + a1*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a2*cos(k2)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a3*cos(k2)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k3)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d2*cos(k2)*cos(k4)*cos(m3)*sin(k3)*sin(m1) + d3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1) + d3*cos(k3)*cos(k4)*cos(m3)*sin(k2)*sin(m1) + d4*cos(k2)*cos(k4)*cos(m2)*sin(k3)*sin(m1) + d3*cos(k4)*cos(m1)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m1)*cos(m3)*sin(k4)*sin(m2) - a1*cos(k2)*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(k2)*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + d2*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(k2)*sin(m1) + d3*cos(k2)*cos(k4)*cos(m2)*cos(m3)*sin(k3)*sin(m1) + d4*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(k4)*sin(m1)) - (cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)))*(a1*cos(k4)*sin(k3)*sin(m1)*sin(m2) - a2*cos(k4)*cos(m1)*cos(m2)*sin(k3) - d2*cos(k2)*cos(k3)*cos(k4)*sin(m1) - a3*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k3)*cos(k4)*cos(m1)*sin(m2) - d4*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(k3)*cos(k4)*cos(m1)*sin(k2) + d3*cos(k4)*sin(k2)*sin(k3)*sin(m1) + d4*cos(k3)*sin(k2)*sin(k4)*sin(m1) + a1*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a2*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d4*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d3*cos(m1)*cos(m3)*sin(k3)*sin(k4)*sin(m2) + d4*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a3*sin(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m3) - d2*sin(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k4)*cos(m1)*cos(m2)*sin(k3) - a2*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1) - d4*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a1*cos(m1)*cos(m3)*sin(k2)*sin(k3)*sin(k4) + a2*cos(k2)*cos(k4)*sin(k3)*sin(m1)*sin(m2) + a1*cos(k2)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + a1*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a2*cos(k2)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a3*cos(k2)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k3)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d2*cos(k4)*cos(m2)*sin(k2)*sin(k3)*sin(m1) + d2*cos(k2)*cos(m3)*sin(k3)*sin(k4)*sin(m1) + d3*cos(k3)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d4*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + d4*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d4*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + d2*cos(k3)*cos(m2)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d3*cos(k2)*cos(m2)*cos(m3)*sin(k3)*sin(k4)*sin(m1)) + (cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a1*cos(m1)*sin(k2)*sin(k3)*sin(m3) - a2*cos(m1)*cos(m3)*sin(m2) - a3*cos(m1)*cos(m2)*sin(m3) - a1*cos(k2)*cos(m1)*cos(m3)*sin(m2) - a2*cos(k2)*cos(m2)*cos(m3)*sin(m1) - a2*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k3)*cos(m1)*cos(m3)*sin(m2) - a1*cos(m2)*cos(m3)*sin(m1) + a3*cos(m3)*sin(k2)*sin(k3)*sin(m1) + a1*cos(k3)*sin(m1)*sin(m2)*sin(m3) + a3*cos(k2)*sin(m1)*sin(m2)*sin(m3) + d2*cos(k2)*sin(k3)*sin(m1)*sin(m3) + d3*cos(k3)*sin(k2)*sin(m1)*sin(m3) + d2*cos(m3)*sin(k2)*sin(m1)*sin(m2) + d3*cos(m1)*sin(k3)*sin(m2)*sin(m3) + d2*cos(k3)*cos(m2)*sin(k2)*sin(m1)*sin(m3) + d3*cos(k2)*cos(m2)*sin(k3)*sin(m1)*sin(m3) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*sin(m1)*sin(m2)*sin(m3)));
Jacobo12 = ((sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) - (cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)));
Jacobo13 = ((a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1))) - (a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3))*(sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2))) - a3*sin(m3)*(cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2))));


v402d_k1 = ((cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a1*cos(m1)*sin(k2)*sin(k3)*sin(m3) - a2*cos(m1)*cos(m3)*sin(m2) - a3*cos(m1)*cos(m2)*sin(m3) - a1*cos(k2)*cos(m1)*cos(m3)*sin(m2) - a2*cos(k2)*cos(m2)*cos(m3)*sin(m1) - a2*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k3)*cos(m1)*cos(m3)*sin(m2) - a1*cos(m2)*cos(m3)*sin(m1) + a3*cos(m3)*sin(k2)*sin(k3)*sin(m1) + a1*cos(k3)*sin(m1)*sin(m2)*sin(m3) + a3*cos(k2)*sin(m1)*sin(m2)*sin(m3) + d2*cos(k2)*sin(k3)*sin(m1)*sin(m3) + d3*cos(k3)*sin(k2)*sin(m1)*sin(m3) + d2*cos(m3)*sin(k2)*sin(m1)*sin(m2) + d3*cos(m1)*sin(k3)*sin(m2)*sin(m3) + d2*cos(k3)*cos(m2)*sin(k2)*sin(m1)*sin(m3) + d3*cos(k2)*cos(m2)*sin(k3)*sin(m1)*sin(m3) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*sin(m1)*sin(m2)*sin(m3)) - (sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a1*cos(k3)*cos(m1)*sin(k2)*sin(k4) - a3*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(m1)*cos(m2)*sin(k3)*sin(k4) + d2*cos(k2)*cos(k3)*sin(k4)*sin(m1) + d4*cos(k3)*cos(k4)*sin(k2)*sin(m1) + a1*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a2*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d3*cos(k3)*cos(m1)*sin(k4)*sin(m2) + d4*cos(k4)*cos(m1)*sin(k3)*sin(m2) + d4*cos(m1)*cos(m2)*sin(k4)*sin(m3) - a1*sin(k3)*sin(k4)*sin(m1)*sin(m2) - d3*sin(k2)*sin(k3)*sin(k4)*sin(m1) - a2*cos(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m2) - a3*cos(k4)*sin(k2)*sin(k3)*sin(m1)*sin(m3) - d2*cos(m2)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d4*cos(m3)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d2*cos(k4)*sin(k2)*sin(m1)*sin(m2)*sin(m3) - d4*cos(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a2*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a1*cos(k2)*cos(m1)*cos(m2)*sin(k3)*sin(k4) + a1*cos(k4)*cos(m1)*cos(m3)*sin(k2)*sin(k3) + a1*cos(k2)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + a1*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a2*cos(k2)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a3*cos(k2)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k3)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d2*cos(k2)*cos(k4)*cos(m3)*sin(k3)*sin(m1) + d3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1) + d3*cos(k3)*cos(k4)*cos(m3)*sin(k2)*sin(m1) + d4*cos(k2)*cos(k4)*cos(m2)*sin(k3)*sin(m1) + d3*cos(k4)*cos(m1)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m1)*cos(m3)*sin(k4)*sin(m2) - a1*cos(k2)*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(k2)*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + d2*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(k2)*sin(m1) + d3*cos(k2)*cos(k4)*cos(m2)*cos(m3)*sin(k3)*sin(m1) + d4*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(k4)*sin(m1)) + (cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a1*cos(k4)*sin(k3)*sin(m1)*sin(m2) - a2*cos(k4)*cos(m1)*cos(m2)*sin(k3) - d2*cos(k2)*cos(k3)*cos(k4)*sin(m1) - a3*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k3)*cos(k4)*cos(m1)*sin(m2) - d4*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(k3)*cos(k4)*cos(m1)*sin(k2) + d3*cos(k4)*sin(k2)*sin(k3)*sin(m1) + d4*cos(k3)*sin(k2)*sin(k4)*sin(m1) + a1*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a2*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d4*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d3*cos(m1)*cos(m3)*sin(k3)*sin(k4)*sin(m2) + d4*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a3*sin(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m3) - d2*sin(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k4)*cos(m1)*cos(m2)*sin(k3) - a2*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1) - d4*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a1*cos(m1)*cos(m3)*sin(k2)*sin(k3)*sin(k4) + a2*cos(k2)*cos(k4)*sin(k3)*sin(m1)*sin(m2) + a1*cos(k2)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + a1*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a2*cos(k2)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a3*cos(k2)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k3)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d2*cos(k4)*cos(m2)*sin(k2)*sin(k3)*sin(m1) + d2*cos(k2)*cos(m3)*sin(k3)*sin(k4)*sin(m1) + d3*cos(k3)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d4*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + d4*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d4*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + d2*cos(k3)*cos(m2)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d3*cos(k2)*cos(m2)*cos(m3)*sin(k3)*sin(k4)*sin(m1)))*d_k1;
v402d_k2 = (- (cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) - (cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)) - (sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)))*d_k2;
v402d_k3 = ((a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3))*(sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)))) - (a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)))) - a3*sin(m3)*(cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)))))*d_k3;

Jacobo21 = ((cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a1*cos(m1)*sin(k2)*sin(k3)*sin(m3) - a2*cos(m1)*cos(m3)*sin(m2) - a3*cos(m1)*cos(m2)*sin(m3) - a1*cos(k2)*cos(m1)*cos(m3)*sin(m2) - a2*cos(k2)*cos(m2)*cos(m3)*sin(m1) - a2*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k3)*cos(m1)*cos(m3)*sin(m2) - a1*cos(m2)*cos(m3)*sin(m1) + a3*cos(m3)*sin(k2)*sin(k3)*sin(m1) + a1*cos(k3)*sin(m1)*sin(m2)*sin(m3) + a3*cos(k2)*sin(m1)*sin(m2)*sin(m3) + d2*cos(k2)*sin(k3)*sin(m1)*sin(m3) + d3*cos(k3)*sin(k2)*sin(m1)*sin(m3) + d2*cos(m3)*sin(k2)*sin(m1)*sin(m2) + d3*cos(m1)*sin(k3)*sin(m2)*sin(m3) + d2*cos(k3)*cos(m2)*sin(k2)*sin(m1)*sin(m3) + d3*cos(k2)*cos(m2)*sin(k3)*sin(m1)*sin(m3) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*sin(m1)*sin(m2)*sin(m3)) - (sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a1*cos(k3)*cos(m1)*sin(k2)*sin(k4) - a3*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(m1)*cos(m2)*sin(k3)*sin(k4) + d2*cos(k2)*cos(k3)*sin(k4)*sin(m1) + d4*cos(k3)*cos(k4)*sin(k2)*sin(m1) + a1*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a2*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d3*cos(k3)*cos(m1)*sin(k4)*sin(m2) + d4*cos(k4)*cos(m1)*sin(k3)*sin(m2) + d4*cos(m1)*cos(m2)*sin(k4)*sin(m3) - a1*sin(k3)*sin(k4)*sin(m1)*sin(m2) - d3*sin(k2)*sin(k3)*sin(k4)*sin(m1) - a2*cos(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m2) - a3*cos(k4)*sin(k2)*sin(k3)*sin(m1)*sin(m3) - d2*cos(m2)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d4*cos(m3)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d2*cos(k4)*sin(k2)*sin(m1)*sin(m2)*sin(m3) - d4*cos(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a2*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a1*cos(k2)*cos(m1)*cos(m2)*sin(k3)*sin(k4) + a1*cos(k4)*cos(m1)*cos(m3)*sin(k2)*sin(k3) + a1*cos(k2)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + a1*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a2*cos(k2)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a3*cos(k2)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k3)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d2*cos(k2)*cos(k4)*cos(m3)*sin(k3)*sin(m1) + d3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1) + d3*cos(k3)*cos(k4)*cos(m3)*sin(k2)*sin(m1) + d4*cos(k2)*cos(k4)*cos(m2)*sin(k3)*sin(m1) + d3*cos(k4)*cos(m1)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m1)*cos(m3)*sin(k4)*sin(m2) - a1*cos(k2)*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(k2)*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + d2*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(k2)*sin(m1) + d3*cos(k2)*cos(k4)*cos(m2)*cos(m3)*sin(k3)*sin(m1) + d4*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(k4)*sin(m1)) + (cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a1*cos(k4)*sin(k3)*sin(m1)*sin(m2) - a2*cos(k4)*cos(m1)*cos(m2)*sin(k3) - d2*cos(k2)*cos(k3)*cos(k4)*sin(m1) - a3*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k3)*cos(k4)*cos(m1)*sin(m2) - d4*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(k3)*cos(k4)*cos(m1)*sin(k2) + d3*cos(k4)*sin(k2)*sin(k3)*sin(m1) + d4*cos(k3)*sin(k2)*sin(k4)*sin(m1) + a1*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a2*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d4*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d3*cos(m1)*cos(m3)*sin(k3)*sin(k4)*sin(m2) + d4*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a3*sin(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m3) - d2*sin(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k4)*cos(m1)*cos(m2)*sin(k3) - a2*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1) - d4*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a1*cos(m1)*cos(m3)*sin(k2)*sin(k3)*sin(k4) + a2*cos(k2)*cos(k4)*sin(k3)*sin(m1)*sin(m2) + a1*cos(k2)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + a1*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a2*cos(k2)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a3*cos(k2)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k3)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d2*cos(k4)*cos(m2)*sin(k2)*sin(k3)*sin(m1) + d2*cos(k2)*cos(m3)*sin(k3)*sin(k4)*sin(m1) + d3*cos(k3)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d4*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + d4*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d4*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + d2*cos(k3)*cos(m2)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d3*cos(k2)*cos(m2)*cos(m3)*sin(k3)*sin(k4)*sin(m1)));
Jacobo22 = (- (cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) - (cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)) - (sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)));
Jacobo23 = ((a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3))*(sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)))) - (a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)))) - a3*sin(m3)*(cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)))));


v403d_k1 = ((sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a1*cos(k3)*cos(m1)*sin(k2)*sin(k4) - a3*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(m1)*cos(m2)*sin(k3)*sin(k4) + d2*cos(k2)*cos(k3)*sin(k4)*sin(m1) + d4*cos(k3)*cos(k4)*sin(k2)*sin(m1) + a1*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a2*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d3*cos(k3)*cos(m1)*sin(k4)*sin(m2) + d4*cos(k4)*cos(m1)*sin(k3)*sin(m2) + d4*cos(m1)*cos(m2)*sin(k4)*sin(m3) - a1*sin(k3)*sin(k4)*sin(m1)*sin(m2) - d3*sin(k2)*sin(k3)*sin(k4)*sin(m1) - a2*cos(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m2) - a3*cos(k4)*sin(k2)*sin(k3)*sin(m1)*sin(m3) - d2*cos(m2)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d4*cos(m3)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d2*cos(k4)*sin(k2)*sin(m1)*sin(m2)*sin(m3) - d4*cos(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a2*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a1*cos(k2)*cos(m1)*cos(m2)*sin(k3)*sin(k4) + a1*cos(k4)*cos(m1)*cos(m3)*sin(k2)*sin(k3) + a1*cos(k2)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + a1*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a2*cos(k2)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a3*cos(k2)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k3)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d2*cos(k2)*cos(k4)*cos(m3)*sin(k3)*sin(m1) + d3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1) + d3*cos(k3)*cos(k4)*cos(m3)*sin(k2)*sin(m1) + d4*cos(k2)*cos(k4)*cos(m2)*sin(k3)*sin(m1) + d3*cos(k4)*cos(m1)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m1)*cos(m3)*sin(k4)*sin(m2) - a1*cos(k2)*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(k2)*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + d2*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(k2)*sin(m1) + d3*cos(k2)*cos(k4)*cos(m2)*cos(m3)*sin(k3)*sin(m1) + d4*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(k4)*sin(m1)) - (sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a1*cos(m1)*sin(k2)*sin(k3)*sin(m3) - a2*cos(m1)*cos(m3)*sin(m2) - a3*cos(m1)*cos(m2)*sin(m3) - a1*cos(k2)*cos(m1)*cos(m3)*sin(m2) - a2*cos(k2)*cos(m2)*cos(m3)*sin(m1) - a2*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k3)*cos(m1)*cos(m3)*sin(m2) - a1*cos(m2)*cos(m3)*sin(m1) + a3*cos(m3)*sin(k2)*sin(k3)*sin(m1) + a1*cos(k3)*sin(m1)*sin(m2)*sin(m3) + a3*cos(k2)*sin(m1)*sin(m2)*sin(m3) + d2*cos(k2)*sin(k3)*sin(m1)*sin(m3) + d3*cos(k3)*sin(k2)*sin(m1)*sin(m3) + d2*cos(m3)*sin(k2)*sin(m1)*sin(m2) + d3*cos(m1)*sin(k3)*sin(m2)*sin(m3) + d2*cos(k3)*cos(m2)*sin(k2)*sin(m1)*sin(m3) + d3*cos(k2)*cos(m2)*sin(k3)*sin(m1)*sin(m3) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*sin(m1)*sin(m2)*sin(m3)) - (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a1*cos(k4)*sin(k3)*sin(m1)*sin(m2) - a2*cos(k4)*cos(m1)*cos(m2)*sin(k3) - d2*cos(k2)*cos(k3)*cos(k4)*sin(m1) - a3*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k3)*cos(k4)*cos(m1)*sin(m2) - d4*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(k3)*cos(k4)*cos(m1)*sin(k2) + d3*cos(k4)*sin(k2)*sin(k3)*sin(m1) + d4*cos(k3)*sin(k2)*sin(k4)*sin(m1) + a1*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a2*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d4*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d3*cos(m1)*cos(m3)*sin(k3)*sin(k4)*sin(m2) + d4*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a3*sin(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m3) - d2*sin(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k4)*cos(m1)*cos(m2)*sin(k3) - a2*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1) - d4*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a1*cos(m1)*cos(m3)*sin(k2)*sin(k3)*sin(k4) + a2*cos(k2)*cos(k4)*sin(k3)*sin(m1)*sin(m2) + a1*cos(k2)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + a1*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a2*cos(k2)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a3*cos(k2)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k3)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d2*cos(k4)*cos(m2)*sin(k2)*sin(k3)*sin(m1) + d2*cos(k2)*cos(m3)*sin(k3)*sin(k4)*sin(m1) + d3*cos(k3)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d4*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + d4*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d4*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + d2*cos(k3)*cos(m2)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d3*cos(k2)*cos(m2)*cos(m3)*sin(k3)*sin(k4)*sin(m1)))*d_k1;
v403d_k2 = ((sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) + (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)))*d_k2;
v403d_k3 = ((a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)))) - (a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3))*(sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)))) + a3*sin(m3)*(sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)))))*d_k3;

Jacobo31 = ((sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a1*cos(k3)*cos(m1)*sin(k2)*sin(k4) - a3*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(m1)*cos(m2)*sin(k3)*sin(k4) + d2*cos(k2)*cos(k3)*sin(k4)*sin(m1) + d4*cos(k3)*cos(k4)*sin(k2)*sin(m1) + a1*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a2*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d3*cos(k3)*cos(m1)*sin(k4)*sin(m2) + d4*cos(k4)*cos(m1)*sin(k3)*sin(m2) + d4*cos(m1)*cos(m2)*sin(k4)*sin(m3) - a1*sin(k3)*sin(k4)*sin(m1)*sin(m2) - d3*sin(k2)*sin(k3)*sin(k4)*sin(m1) - a2*cos(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m2) - a3*cos(k4)*sin(k2)*sin(k3)*sin(m1)*sin(m3) - d2*cos(m2)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d4*cos(m3)*sin(k2)*sin(k3)*sin(k4)*sin(m1) - d2*cos(k4)*sin(k2)*sin(m1)*sin(m2)*sin(m3) - d4*cos(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a2*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a1*cos(k2)*cos(m1)*cos(m2)*sin(k3)*sin(k4) + a1*cos(k4)*cos(m1)*cos(m3)*sin(k2)*sin(k3) + a1*cos(k2)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + a1*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a2*cos(k2)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + a3*cos(k2)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k3)*cos(k4)*cos(m1)*sin(m2)*sin(m3) + d2*cos(k2)*cos(k4)*cos(m3)*sin(k3)*sin(m1) + d3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1) + d3*cos(k3)*cos(k4)*cos(m3)*sin(k2)*sin(m1) + d4*cos(k2)*cos(k4)*cos(m2)*sin(k3)*sin(m1) + d3*cos(k4)*cos(m1)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m1)*cos(m3)*sin(k4)*sin(m2) - a1*cos(k2)*cos(k3)*cos(k4)*cos(m1)*cos(m2)*cos(m3) + a2*cos(k2)*cos(k3)*cos(k4)*cos(m3)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1)*sin(m3) + d2*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(k2)*sin(m1) + d3*cos(k2)*cos(k4)*cos(m2)*cos(m3)*sin(k3)*sin(m1) + d4*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(k4)*sin(m1)) - (sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a1*cos(m1)*sin(k2)*sin(k3)*sin(m3) - a2*cos(m1)*cos(m3)*sin(m2) - a3*cos(m1)*cos(m2)*sin(m3) - a1*cos(k2)*cos(m1)*cos(m3)*sin(m2) - a2*cos(k2)*cos(m2)*cos(m3)*sin(m1) - a2*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k3)*cos(m1)*cos(m3)*sin(m2) - a1*cos(m2)*cos(m3)*sin(m1) + a3*cos(m3)*sin(k2)*sin(k3)*sin(m1) + a1*cos(k3)*sin(m1)*sin(m2)*sin(m3) + a3*cos(k2)*sin(m1)*sin(m2)*sin(m3) + d2*cos(k2)*sin(k3)*sin(m1)*sin(m3) + d3*cos(k3)*sin(k2)*sin(m1)*sin(m3) + d2*cos(m3)*sin(k2)*sin(m1)*sin(m2) + d3*cos(m1)*sin(k3)*sin(m2)*sin(m3) + d2*cos(k3)*cos(m2)*sin(k2)*sin(m1)*sin(m3) + d3*cos(k2)*cos(m2)*sin(k3)*sin(m1)*sin(m3) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*sin(m3) - a3*cos(k2)*cos(k3)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*sin(m1)*sin(m2)*sin(m3)) - (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a1*cos(k4)*sin(k3)*sin(m1)*sin(m2) - a2*cos(k4)*cos(m1)*cos(m2)*sin(k3) - d2*cos(k2)*cos(k3)*cos(k4)*sin(m1) - a3*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k3)*cos(k4)*cos(m1)*sin(m2) - d4*cos(k4)*cos(m1)*cos(m2)*sin(m3) - a1*cos(k3)*cos(k4)*cos(m1)*sin(k2) + d3*cos(k4)*sin(k2)*sin(k3)*sin(m1) + d4*cos(k3)*sin(k2)*sin(k4)*sin(m1) + a1*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a2*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d4*cos(m1)*sin(k3)*sin(k4)*sin(m2) + d3*cos(m1)*cos(m3)*sin(k3)*sin(k4)*sin(m2) + d4*cos(k2)*cos(k4)*sin(m1)*sin(m2)*sin(m3) - a3*sin(k2)*sin(k3)*sin(k4)*sin(m1)*sin(m3) - d2*sin(k2)*sin(k4)*sin(m1)*sin(m2)*sin(m3) - a1*cos(k2)*cos(k4)*cos(m1)*cos(m2)*sin(k3) - a2*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d3*cos(k2)*cos(k3)*cos(k4)*cos(m2)*sin(m1) - d4*cos(k3)*cos(k4)*cos(m1)*cos(m3)*sin(m2) + a1*cos(m1)*cos(m3)*sin(k2)*sin(k3)*sin(k4) + a2*cos(k2)*cos(k4)*sin(k3)*sin(m1)*sin(m2) + a1*cos(k2)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + a1*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a2*cos(k2)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + a3*cos(k2)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k3)*cos(m1)*sin(k4)*sin(m2)*sin(m3) + d2*cos(k4)*cos(m2)*sin(k2)*sin(k3)*sin(m1) + d2*cos(k2)*cos(m3)*sin(k3)*sin(k4)*sin(m1) + d3*cos(k3)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d4*cos(k2)*cos(m2)*sin(k3)*sin(k4)*sin(m1) + d4*cos(k4)*cos(m3)*sin(k2)*sin(k3)*sin(m1) - a1*cos(k2)*cos(k3)*cos(m1)*cos(m2)*cos(m3)*sin(k4) - d4*cos(k2)*cos(k3)*cos(k4)*cos(m2)*cos(m3)*sin(m1) + a2*cos(k2)*cos(k3)*cos(m3)*sin(k4)*sin(m1)*sin(m2) + a3*cos(k2)*cos(k3)*cos(m2)*sin(k4)*sin(m1)*sin(m3) + d2*cos(k3)*cos(m2)*cos(m3)*sin(k2)*sin(k4)*sin(m1) + d3*cos(k2)*cos(m2)*cos(m3)*sin(k3)*sin(k4)*sin(m1)));
Jacobo32 = ((sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) + (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)));
Jacobo33 = ((a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)))) - (a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3))*(sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)))) + a3*sin(m3)*(sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)))));

Jacobo = [Jacobo11 Jacobo12 Jacobo13;Jacobo21 Jacobo22 Jacobo23;Jacobo31 Jacobo32 Jacobo33];

syms z1 z0 x1 x0 y1 y0
Vx = Jacobo12*d_k2 + Jacobo13*d_k3
Vy = Jacobo22*d_k2 + Jacobo23*d_k3
Vz = Jacobo32*d_k2 + Jacobo33*d_k3
% Vz = (z1-z0)/(x1-x0)*Vx
Vz = (z1-z0)/(y1-y0)*Vy
% d_k2 = Vz/Jacobo32-(Jacobo33/Jacobo32)*d_k3;
re = collect(simplify(Vz/Jacobo32-(Jacobo33/Jacobo32)*d_k3-d_k2),[d_k2 d_k3]) %==0

% if x1~=x0
kd_k2_divide_d_k3_x1NEx0 = -(- ((a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)))) - (a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3))*(sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)))) + a3*sin(m3)*(sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)))))/((sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) + (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2))) - ((z0 - z1)*((a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3))*(sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2))) - (a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1))) + a3*sin(m3)*(cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))))/((x0 - x1)*((sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) + (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)))))/((((z0 - z1)*((sin(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + cos(k4)*cos(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) - (cos(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)) + sin(m3)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (cos(k4)*(cos(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) - cos(m2)*sin(k3)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + sin(k1)*sin(k3)*sin(m1)*sin(m2)) - cos(m3)*sin(k4)*(sin(k3)*(cos(k1)*cos(k2) - cos(m1)*sin(k1)*sin(k2)) + cos(k3)*cos(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) - cos(k3)*sin(k1)*sin(m1)*sin(m2)) + sin(k4)*sin(m3)*(sin(m2)*(cos(k1)*sin(k2) + cos(k2)*cos(m1)*sin(k1)) + cos(m2)*sin(k1)*sin(m1)))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2))))/((x0 - x1)*((sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) + (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)))) - 1));

% if y1 ~=y0 
kd_k2_divide_d_k3_y1NEy0 = -((- ((a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)))) - (a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3))*(sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)))) + a3*sin(m3)*(sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)))))/((sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) + (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2))) - ((z0 - z1)*((a3*cos(m3)*sin(k4) + d4*cos(k4)*sin(m3))*(cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)))) - (a3*cos(k4)*cos(m3) - d4*sin(k4)*sin(m3))*(sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)))) + a3*sin(m3)*(cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))))/((y0 - y1)*((sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) + (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2))))))/((- ((z0 - z1)*((cos(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + sin(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (cos(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) - sin(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) + cos(m3)*sin(k4)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)) + (sin(k4)*(sin(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) - cos(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(m2)*sin(k3)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))) + cos(k4)*sin(m3)*(sin(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1)) - cos(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1))) - cos(k4)*cos(m3)*(sin(k3)*(cos(k2)*cos(m0)*sin(k1) - sin(k2)*sin(m0)*sin(m1) + cos(k1)*cos(m0)*cos(m1)*sin(k2)) + cos(k3)*sin(m2)*(cos(m1)*sin(m0) + cos(k1)*cos(m0)*sin(m1)) + cos(k3)*cos(m2)*(cos(m0)*sin(k1)*sin(k2) + cos(k2)*sin(m0)*sin(m1) - cos(k1)*cos(k2)*cos(m0)*cos(m1))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3))))/((y0 - y1)*((sin(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))))*(a2*cos(m3)*sin(m2) + a3*cos(m2)*sin(m3) + a2*cos(k3)*cos(m2)*sin(m3) + a3*cos(k3)*cos(m3)*sin(m2) - d3*sin(k3)*sin(m2)*sin(m3)) + (sin(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) + cos(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) - cos(k4)*cos(m3)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(m2)*sin(k3)*sin(k4) - a3*cos(k4)*cos(m2)*cos(m3) + a2*cos(k4)*sin(m2)*sin(m3) + d3*cos(k3)*sin(k4)*sin(m2) + d4*cos(k4)*sin(k3)*sin(m2) + d4*cos(m2)*sin(k4)*sin(m3) + a3*cos(k3)*cos(k4)*sin(m2)*sin(m3) + d3*cos(k4)*cos(m3)*sin(k3)*sin(m2) + d4*cos(k3)*cos(m3)*sin(k4)*sin(m2) - a2*cos(k3)*cos(k4)*cos(m2)*cos(m3)) + (cos(k4)*(cos(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + sin(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) + cos(m2)*sin(k3)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))) - sin(k4)*sin(m3)*(sin(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0)) - cos(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1))) + cos(m3)*sin(k4)*(cos(k3)*sin(m2)*(cos(m0)*cos(m1) - cos(k1)*sin(m0)*sin(m1)) - sin(k3)*(cos(k2)*sin(k1)*sin(m0) + cos(m0)*sin(k2)*sin(m1) + cos(k1)*cos(m1)*sin(k2)*sin(m0)) + cos(k3)*cos(m2)*(cos(k2)*cos(m0)*sin(m1) - sin(k1)*sin(k2)*sin(m0) + cos(k1)*cos(k2)*cos(m1)*sin(m0))))*(a2*cos(k4)*cos(m2)*sin(k3) + a3*cos(m2)*cos(m3)*sin(k4) + d3*cos(k3)*cos(k4)*sin(m2) + d4*cos(k4)*cos(m2)*sin(m3) - a2*sin(k4)*sin(m2)*sin(m3) - d4*sin(k3)*sin(k4)*sin(m2) + a2*cos(k3)*cos(m2)*cos(m3)*sin(k4) + d4*cos(k3)*cos(k4)*cos(m3)*sin(m2) - a3*cos(k3)*sin(k4)*sin(m2)*sin(m3) - d3*cos(m3)*sin(k3)*sin(k4)*sin(m2)))) - 1));

% d_k2 = simplify(d_k2)




